<section class="space-y-6">
  <%= render "shared/button", text: "Back", url: admin_root_path, class: "py-0" %>
  <div class="flex items-center justify-between">
    <h1 class="pb-2 text-4xl">All Users</h1>
    <%= form_with url: admin_users_path, method: :get, local: true, class: "w-full max-w-2xl" do %>
      <div class="flex items-center gap-3">
        <input type="text" name="q" value="<%= h(@q) %>" placeholder="Search by ID, name, email, or Slack ID" class="w-full text-white border-white rounded-none input bg-bp-darker placeholder-white/60" />
        <button type="submit" class="text-lg rounded-none btn btn-primary">Search</button>
      </div>
    <% end %>
  </div>

  <div class="border-2 border-white rounded-none">
    <!-- Header row -->
    <div class="grid grid-cols-12 p-3 text-lg border-b-2 border-white">
      <div class="col-span-1">ID</div>
      <div class="col-span-2">Name</div>
      <div class="col-span-4">Email</div>
      <div class="col-span-2">Last active</div>
      <div class="col-span-2">Slack ID</div>
      <div class="col-span1">Actions</div>
    </div>

    <!-- Rows -->
    <% if @users.present? %>
      <% @users.each do |user| %>
        <div class="grid grid-cols-12 px-3 text-lg border-b border-white/30 last:border-0">
          <div class="flex items-center col-span-1 py-2"><%= user.id %></div>
          <div class="flex items-center col-span-2 font-medium">
            <%= link_to user.display_name, admin_user_path(user), class: "underline decoration-white/30 underline-offset-2 hover:decoration-white" %>
          </div>
          <div class="flex items-center col-span-4">
            <% if current_user.admin? %>
              <% if user.email.present? %>
                <a href="mailto:<%= h user.email %>" class="underline decoration-white/30 underline-offset-2 hover:decoration-white"><%= user.email %></a>
              <% else %>
                <p>–</p>
              <% end %>
            <% else %>
              <p>[ Hidden ]</p>
            <% end %>
          </div>
          <div class="flex items-center col-span-2"><%= user.last_active ? time_ago_in_words(user.last_active) : "Never" %></div>
          <div class="flex items-center col-span-2"><%= user.slack_id.presence || "–" %></div>
          <div class="flex items-center col-span-1">
            <div class="flex items-center gap-2">
              <%= render "shared/button", text: "View", url: admin_user_path(user), class: "text-sm py-0 px-2" %>
            </div>
          </div>
        </div>
      <% end %>
    <% else %>
      <div class="px-4 py-6 text-center text-white/70">No users found.</div>
    <% end %>
  </div>

  <div class="flex items-center justify-end text-lg">
    <%== pagy_nav(@pagy) if @pagy.present? && @pagy.pages > 1 %>
  </div>
</section>
